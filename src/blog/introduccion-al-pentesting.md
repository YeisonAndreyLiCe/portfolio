---
title: Introducción a Pentesting
pubDate: 2024-11-04
description: "Introducción a Pentesting"
tags: ["security"]
isDraft: true
snippet:
  language: "bash"
  code: "nmap -sV -sC -p- 10.10.10.10"
---

El pentesting (pruebas de penetración) es una práctica de seguridad informática
en la que se realizan ataques controlados a sistemas para identificar
vulnerabilidades antes que los atacantes maliciosos. Este proceso sistemático
ayuda a las organizaciones a fortalecer sus defensas mediante la identificación
y mitigación de riesgos de seguridad.

## Fases del Pentesting

1. **Reconocimiento**: Recopilación de información sobre el objetivo
2. **Escaneo**: Identificación de servicios y posibles vulnerabilidades
3. **Obtención de acceso**: Explotación de vulnerabilidades encontradas
4. **Mantenimiento de acceso**: Prueba de persistencia en los sistemas
5. **Borrado de huellas**: Eliminación de evidencias de la intrusión

## Herramientas Fundamentales

- **Nmap**: Escáner de puertos y análisis de red
- **Metasploit**: Framework para desarrollar y ejecutar exploits
- **Burp Suite**: Interceptor de tráfico web para pruebas de aplicaciones
- **Wireshark**: Analizador de protocolos de red
- **John the Ripper**: Herramienta para craqueo de contraseñas

## Common Vulnerabilities and Exposures (CVE)

Common Vulnerabilities and Exposures (CVE) es un sistema de identificación
estandarizado para vulnerabilidades de seguridad conocidas públicamente. Cada
CVE tiene un identificador único (ID) que facilita el intercambio de datos
entre diferentes herramientas, bases de datos y servicios de seguridad.

### Características principales del sistema CVE

- **Identificación única**: Cada vulnerabilidad recibe un ID en formato
  CVE-YYYY-NNNNN
- **Descripción estandarizada**: Información concisa sobre la naturaleza de
  la vulnerabilidad
- **Referencias técnicas**: Enlaces a boletines de seguridad, parches y
  documentación adicional
- **Métricas de severidad**: A menudo asociadas con puntuaciones CVSS
  (Common Vulnerability Scoring System)

### Importancia de los CVE en pentesting

- Proporciona un lenguaje común para identificar vulnerabilidades específicas
- Permite el seguimiento histórico de problemas de seguridad en productos y
  sistemas
- Facilita la priorización de parches y mitigaciones según la gravedad
- Ayuda a documentar hallazgos de manera consistente en informes de pentesting

Los profesionales de seguridad utilizan bases de datos de CVE para mantenerse
actualizados sobre las últimas vulnerabilidades y verificar si los sistemas que
evalúan están afectados por problemas conocidos.

## Common Witness Enumeration (CWE)

Common Weakness Enumeration (CWE) is a community-developed list of common
software and hardware security weaknesses. It serves as a common language
for describing security vulnerabilities in architecture, design, or code. Think
of it as a dictionary or categorization system for security flaws.

### Key aspects of CWE

- **Standardized identification**: Each weakness has a unique CWE ID
  (e.g., CWE-79 for Cross-Site Scripting)
- **Hierarchical organization**: Weaknesses are organized in categories and
  have relationships to one another
- **Common language**: Provides a standardized terminology for discussing
  vulnerabilities across teams and tools
- **Risk assessment**: Helps prioritize vulnerabilities based on their
  potential impact

### Why CWE is important

- Enables consistent identification of vulnerabilities across different
  security tools
- Helps developers understand and avoid common security mistakes
- Provides a framework for security training and awareness
- Supports better vulnerability management processes

Security scanners often report findings with associated CWE IDs, making it
easier to understand the type of vulnerability detected and how to remediate it.

## Common Attack Pattern Enumeration and Classification (CAPEC)

Common Attack Pattern Enumeration and Classification (CAPEC) is a comprehensive
dictionary and classification taxonomy of known attacks that can be used by
adversaries to exploit vulnerabilities. Developed by MITRE, CAPEC helps security
professionals understand how attackers think and operate.

### Key elements of CAPEC

- **Attack patterns**: Detailed descriptions of common methods for exploiting
  weaknesses
- **Hierarchical structure**: Organized from meta patterns to detailed attack
  techniques
- **Comprehensive coverage**: Includes social engineering, supply chain,
  physical, and cyber attacks
- **Practical context**: Provides examples, execution flow, and prerequisites
  for each attack pattern

### Benefits for pentesters

- Helps model threat scenarios more accurately
- Provides a methodical approach to testing security controls
- Enables more thorough coverage of potential attack vectors
- Assists in explaining attack methodologies to non-technical stakeholders

CAPEC complements CVE and CWE by focusing on the attack methods rather than
the vulnerabilities themselves, forming a complete picture of the security
landscape when used together.

## Common Vulnerability Scoring System (CVSS)

The Common Vulnerability Scoring System (CVSS) is a standardized framework for
assessing the severity of security vulnerabilities. It provides a way to
capture the principal characteristics of a vulnerability and produce a
numerical score reflecting its severity, which can then be translated into
a qualitative representation (such as low, medium, high, and critical).

### CVSS v3 Components

- **Base Score**: Represents the intrinsic qualities of a vulnerability that
  are constant over time

  - **Exploitability Metrics**: Attack Vector, Attack Complexity, Privileges
    Required, User Interaction
  - **Impact Metrics**: Confidentiality, Integrity, Availability
  - **Scope**: Whether the vulnerability affects resources beyond its security
    scope

- **Temporal Score**: Reflects characteristics that evolve over the lifetime of
  a vulnerability

  - Exploit Code Maturity
  - Remediation Level
  - Report Confidence

- **Environmental Score**: Customizes the Base Score for a specific environment
  - Modified Base Metrics
  - Impact Subscore Modifiers

### CVSS Severity Ratings

| Score Range | Severity Rating |
| ----------- | --------------- |
| 0.0         | None            |
| 0.1 - 3.9   | Low             |
| 4.0 - 6.9   | Medium          |
| 7.0 - 8.9   | High            |
| 9.0 - 10.0  | Critical        |

### Benefits in Pentesting

- Provides an objective assessment of vulnerability severity
- Helps prioritize remediation efforts based on risk
- Facilitates clear communication about security risks to stakeholders
- Enables consistent comparison of vulnerabilities across different systems

Security professionals use CVSS scores to efficiently allocate resources to
fix the most severe vulnerabilities first, an essential practice in risk
management.

## Fases Detalladas del Pentesting

### 1. Reconocimiento (Footprinting)

El reconocimiento implica la recopilación metódica de información sobre el
objetivo sin interactuar directamente con sus sistemas. Esta fase incluye:

- **OSINT (Open Source Intelligence)**: Recopilación de datos de fuentes
  públicas
- **Enumeración de dominios**: Descubrimiento de subdominios y servicios
  asociados
- **Reconocimiento pasivo**: Análisis de presencia digital sin alertar al
  objetivo
- **Reconocimiento social**: Investigación sobre empleados y estructura
  organizacional

### 2. Escaneo y Enumeración

Esta fase implica interacción directa con los sistemas objetivo para
identificar:

- **Hosts activos**: Determinación de dispositivos conectados a la red
- **Puertos abiertos**: Identificación de servicios accesibles
- **Versiones de software**: Detección de versiones para asociar con
  vulnerabilidades conocidas
- **Tecnologías implementadas**: Mapeo de la infraestructura tecnológica

### 3. Análisis de Vulnerabilidades

Evaluación sistemática para detectar debilidades explotables:

- **Escaneos automatizados**: Uso de herramientas especializadas para detectar
  fallos conocidos
- **Verificación manual**: Confirmación de positivos y eliminación de falsos
  positivos
- **Priorización de hallazgos**: Clasificación de vulnerabilidades según su
  impacto potencial

### 4. Explotación

Aprovechamiento controlado de las vulnerabilidades identificadas:

- **Desarrollo de exploits**: Creación o adaptación de exploits específicos
- **Escalada de privilegios**: Aumento de permisos en sistemas comprometidos
- **Pivoting**: Uso de sistemas comprometidos para acceder a otras partes de
  la red

### 5. Post-Explotación

Evaluación del impacto real de las vulnerabilidades explotadas:

- **Extracción de datos**: Demostración del acceso a información sensible
- **Establecimiento de persistencia**: Prueba de capacidad para mantener acceso
- **Movimiento lateral**: Expansión del acceso a otros sistemas

### 6. Documentación y Reporte

Compilación formal de hallazgos y recomendaciones:

- **Documentación técnica**: Detalles precisos sobre vulnerabilidades
  encontradas
- **Análisis de riesgo**: Evaluación del impacto potencial en el negocio
- **Plan de remediación**: Pasos concretos para mitigar las vulnerabilidades
- **Informe ejecutivo**: Resumen accesible para la dirección y responsables
  de toma de decisiones

CVE => Identificación única de una vulnerabilidad

CWE => A que tipo pertenece esta vulnerabilidad

CAPEC => Cual es el patron de ataque que esta relacionado.

## References

- [CAPEC](https://capec.mitre.org/)
- [NVD - CVSS](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)
- [SUBGRAPH](https://subgraph.com/vega/)
- [Exploit](https://www.exploit-db.com/)
- [0day](https://0day.today/)

The attack surface is the set of operations (e.g., its API and its open network
ports) that a potential attacker can access.
